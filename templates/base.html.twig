<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ app_name }}{% endblock %}</title>
    <link rel="icon" type="image/png" href="/images/logo-itroom.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    {% block stylesheets %}
        <style>
            :root {
                --primary-color: #f59c16;
                --primary-dark: #d98913;
                --info-color: #016dae;
                --info-dark: #014d7a;
                --secondary-color: #5a6268;
                --secondary-dark: #454d53;
                --critical-color: #dc3545;
                --major-color: #fd7e14;
                --minor-color: #ffc107;
                --success-color: #198754;

                /* Light mode colors */
                --text-dark: #333;
                --text-medium: #4c4c4c;
                --text-light: #999;
                --bg-light: #f8f8f8;
                --bg-white: #ffffff;
                --border-color: #dee2e6;
                --shadow-color: rgba(0,0,0,.08);
                --card-bg: #ffffff;
                --navbar-bg: #ffffff;
                --footer-bg: #ffffff;
                --input-bg: #ffffff;
                --code-bg: #f8f8f8;
            }

            [data-theme="dark"] {
                /* Textes avec meilleur contraste */
                --text-dark: #f5f5f5;
                --text-medium: #d0d0d0;
                --text-light: #a0a0a0;

                /* Backgrounds */
                --bg-light: #0f0f0f;
                --bg-white: #1a1a1a;
                --border-color: #404040;
                --shadow-color: rgba(0,0,0,.5);
                --card-bg: #1e1e1e;
                --navbar-bg: #1a1a1a;
                --footer-bg: #1a1a1a;
                --input-bg: #252525;
                --code-bg: #0f0f0f;

                /* Couleurs primaires l√©g√®rement plus claires pour mode sombre */
                --primary-color: #ffa726;
                --primary-dark: #fb8c00;
                --info-color: #29b6f6;
                --info-dark: #039be5;
                --success-color: #66bb6a;
            }

            * {
                transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
            }

            body {
                font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
                background-color: var(--bg-light);
                font-size: 18px;
                line-height: 1.5;
                color: var(--text-medium);
            }

            .navbar {
                background-color: var(--navbar-bg) !important;
                box-shadow: 0 2px 10px var(--shadow-color);
                border-bottom: 2px solid transparent;
                transition: all 0.3s ease;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 1000;
            }

            .navbar-brand {
                color: var(--text-dark) !important;
                font-weight: 700;
                font-size: 1.5rem;
            }

            .navbar .nav-link {
                color: var(--text-medium) !important;
                font-weight: 600;
                padding: 0.5rem 1rem;
                transition: all 0.1s ease-in-out;
                border-bottom: 2px solid transparent;
            }

            .navbar .nav-link:hover {
                color: var(--info-color) !important;
                border-bottom-color: var(--info-dark);
            }

            body {
                padding-top: 70px;
            }

            .sidebar {
                min-height: calc(100vh - 70px);
                background-color: var(--card-bg);
                border-right: 1px solid var(--border-color);
                padding-top: 1rem;
                position: sticky;
                top: 70px;
            }

            .sidebar .nav-link {
                color: var(--text-medium);
                font-weight: 600;
                padding: 12px 20px;
                margin: 4px 0;
                border-radius: 0;
                border-left: 3px solid transparent;
                transition: all 0.2s ease;
            }

            .sidebar .nav-link:hover,
            .sidebar .nav-link.active {
                color: var(--info-color);
                background-color: rgba(1, 109, 174, 0.05);
                border-left-color: var(--info-color);
            }

            .content-area {
                padding: 2rem;
            }

            /* Responsive Sidebar */
            @media (max-width: 767.98px) {
                .sidebar {
                    position: fixed;
                    top: 70px;
                    left: -100%;
                    width: 280px;
                    height: calc(100vh - 70px);
                    z-index: 999;
                    transition: left 0.3s ease;
                    box-shadow: 2px 0 10px var(--shadow-color);
                }

                .sidebar.show {
                    left: 0;
                }

                .content-area {
                    padding: 1rem;
                    margin-left: 0 !important;
                }

                /* Overlay pour fermer la sidebar */
                .sidebar-overlay {
                    position: fixed;
                    top: 70px;
                    left: 0;
                    width: 100%;
                    height: calc(100vh - 70px);
                    background-color: rgba(0, 0, 0, 0.5);
                    z-index: 998;
                    display: none;
                }

                .sidebar-overlay.show {
                    display: block;
                }

                /* Burger menu button */
                .sidebar-toggle {
                    display: block !important;
                    position: fixed;
                    bottom: 20px;
                    right: 20px;
                    width: 56px;
                    height: 56px;
                    background-color: var(--primary-color);
                    color: #000;
                    border: none;
                    border-radius: 50%;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                    z-index: 1000;
                    font-size: 24px;
                    cursor: pointer;
                    transition: transform 0.2s ease;
                }

                .sidebar-toggle:hover {
                    transform: scale(1.1);
                }

                .sidebar-toggle:active {
                    transform: scale(0.95);
                }
            }

            /* Desktop - hide toggle button */
            @media (min-width: 768px) {
                .sidebar-toggle {
                    display: none !important;
                }

                .sidebar-overlay {
                    display: none !important;
                }
            }

            .severity-badge {
                font-size: 0.875rem;
                font-weight: 600;
                padding: 0.375rem 0.75rem;
                border-radius: 8px;
            }

            .severity-critical {
                background-color: var(--critical-color);
                color: white;
            }

            .severity-major {
                background-color: var(--major-color);
                color: white;
            }

            .severity-minor {
                background-color: var(--minor-color);
                color: #000;
            }

            h1, h2, h3, h4, h5, h6 {
                font-family: 'Open Sans', sans-serif;
                color: var(--text-dark);
                font-weight: 400;
            }

            h2 {
                font-size: 1.7rem;
            }

            h3 {
                font-size: 1.5rem;
            }

            .btn-primary {
                background-color: var(--primary-color);
                border-color: var(--primary-color);
                border-radius: 8px;
                padding: 10px 24px;
                font-weight: 600;
                transition: all 0.3s ease;
            }

            .btn-primary:hover {
                background-color: var(--primary-dark);
                border-color: var(--primary-dark);
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(245, 156, 22, 0.3);
            }

            .btn-secondary {
                background-color: var(--secondary-color);
                border-color: var(--secondary-color);
                border-radius: 8px;
                padding: 10px 24px;
                font-weight: 600;
                transition: all 0.3s ease;
            }

            .btn-secondary:hover {
                background-color: var(--secondary-dark);
                border-color: var(--secondary-dark);
            }

            .btn {
                border-radius: 8px;
            }

            .card {
                border: none;
                background-color: var(--card-bg);
                box-shadow: 0 2px 8px var(--shadow-color);
                margin-bottom: 1.5rem;
                border-radius: 8px;
                transition: all 0.3s ease;
            }

            .card:hover {
                box-shadow: 0 4px 16px var(--shadow-color);
            }

            .card-body, .card-header, .card-footer {
                background-color: var(--card-bg);
                color: var(--text-medium);
            }

            .card-header {
                border-bottom: 1px solid var(--border-color);
            }

            .stat-card {
                border-left: 4px solid var(--info-color);
            }

            .form-control, .form-select {
                border-radius: 8px;
                padding: 12px 16px;
                border: 1px solid var(--border-color);
                background-color: var(--input-bg);
                color: var(--text-dark);
                font-size: 16px;
                transition: all 0.2s ease;
            }

            .form-control:focus, .form-select:focus {
                border-color: var(--info-color);
                background-color: var(--input-bg);
                box-shadow: 0 0 0 0.2rem rgba(1, 109, 174, 0.25);
                color: var(--text-dark);
            }

            pre code {
                display: block;
                padding: 1rem;
                background-color: var(--code-bg);
                border-radius: 8px;
                overflow-x: auto;
                color: var(--text-dark);
            }

            .conformity-rate {
                font-size: 3rem;
                font-weight: 700;
                color: var(--info-color);
            }

            .chart-container {
                position: relative;
                height: 300px;
            }

            .table {
                background-color: var(--card-bg);
                color: var(--text-medium);
            }

            .table thead {
                background-color: var(--bg-light);
                color: var(--text-dark);
            }

            .table tbody tr {
                border-color: var(--border-color);
            }

            .table tbody tr:hover {
                background-color: var(--bg-light);
            }

            .badge {
                font-weight: 600;
                padding: 6px 12px;
                border-radius: 8px;
            }

            .dropdown-menu {
                border: none;
                box-shadow: 0 4px 12px rgba(0,0,0,.1);
                border-radius: 8px;
                margin-top: 8px;
            }

            .dropdown-item {
                padding: 10px 20px;
                color: var(--text-medium);
                transition: all 0.2s ease;
            }

            .dropdown-item:hover {
                background-color: rgba(1, 109, 174, 0.05);
                color: var(--info-color);
            }

            .alert {
                border-radius: 8px;
                border: none;
                box-shadow: 0 2px 8px rgba(0,0,0,.08);
            }

            a {
                color: var(--info-color);
                text-decoration: none;
                transition: color 0.2s ease;
            }

            a:hover {
                color: var(--info-dark);
            }

            .navbar-toggler {
                border: none;
            }

            .navbar-toggler:focus {
                box-shadow: none;
            }

            .footer {
                background-color: var(--footer-bg);
                box-shadow: 0 -2px 10px var(--shadow-color);
                margin-top: auto;
            }

            .footer a {
                transition: color 0.2s ease;
            }

            .footer a:hover {
                color: var(--info-color) !important;
            }

            html {
                min-height: 100vh;
                display: flex;
                flex-direction: column;
            }

            body {
                flex: 1;
                display: flex;
                flex-direction: column;
            }

            .container-fluid {
                flex: 1;
            }

            /* Dark Mode Toggle */
            .theme-toggle {
                position: relative;
                display: inline-block;
                width: 50px;
                height: 26px;
            }

            .theme-toggle input {
                opacity: 0;
                width: 0;
                height: 0;
            }

            .theme-toggle-slider {
                position: absolute;
                cursor: pointer;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: #ccc;
                transition: .3s;
                border-radius: 13px;
            }

            .theme-toggle-slider:before {
                position: absolute;
                content: "‚òÄÔ∏è";
                height: 20px;
                width: 20px;
                left: 3px;
                bottom: 3px;
                background-color: white;
                transition: .3s;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 12px;
            }

            .theme-toggle input:checked + .theme-toggle-slider {
                background-color: var(--info-color);
            }

            .theme-toggle input:checked + .theme-toggle-slider:before {
                transform: translateX(24px);
                content: "üåô";
            }

            .accordion-item {
                background-color: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 8px !important;
                margin-bottom: 8px;
                overflow: hidden;
                transition: all 0.2s ease;
            }

            .accordion-item:hover {
                box-shadow: 0 2px 8px var(--shadow-color);
            }

            .accordion-button {
                background-color: var(--bg-light);
                color: var(--text-dark);
                border: none;
                padding: 16px 20px;
                font-weight: 500;
                transition: all 0.2s ease;
            }

            .accordion-button:hover {
                background-color: rgba(1, 109, 174, 0.05);
            }

            .accordion-button:not(.collapsed) {
                background-color: rgba(1, 109, 174, 0.08);
                color: var(--info-color);
                box-shadow: none;
            }

            .accordion-button:focus {
                box-shadow: none;
                border-color: transparent;
            }

            .dropdown-menu {
                background-color: var(--card-bg);
                border-color: var(--border-color);
            }

            .modal-content {
                background-color: var(--card-bg);
                color: var(--text-medium);
            }

            .modal-header, .modal-footer {
                border-color: var(--border-color);
            }

            /* Logo visibility in dark mode */
            [data-theme="dark"] .navbar-brand img,
            [data-theme="dark"] .footer img {
                filter: brightness(0.9);
            }

            /* Alert styles */
            .alert {
                border-color: var(--border-color);
            }

            /* Tabs navigation */
            .nav-tabs .nav-link {
                color: var(--text-medium);
                border: none;
                border-bottom: 3px solid transparent;
                transition: all 0.2s ease;
            }

            .nav-tabs .nav-link:hover {
                color: var(--info-color);
                border-bottom-color: var(--info-color);
            }

            .nav-tabs .nav-link.active {
                color: var(--info-color);
                background-color: transparent;
                border: none;
                border-bottom: 3px solid var(--info-color);
                font-weight: 600;
            }

            /* Modern Radio Buttons for RGAA Grid */
            .manual-check-row .btn-group-vertical {
                display: flex;
                flex-direction: row;
                gap: 8px;
                width: 100%;
                align-items: center;
                justify-content: center;
            }

            .manual-check-row .btn-check {
                display: none;
            }

            .manual-check-row .btn {
                border-radius: 8px;
                padding: 8px 16px;
                font-size: 14px;
                font-weight: 500;
                border: 2px solid;
                transition: all 0.2s ease;
                flex: 1;
            }

            .manual-check-row .btn-outline-success {
                border-color: #198754;
                color: #198754;
                background-color: transparent;
                border-radius: 8px !important;
            }

            .manual-check-row .btn-outline-success:hover {
                background-color: rgba(25, 135, 84, 0.1);
                border-radius: 8px !important;
            }

            .manual-check-row .btn-check:checked + .btn-outline-success {
                background-color: #198754;
                color: white;
                border-color: #198754;
                border-radius: 8px !important;
            }

            .manual-check-row .btn-outline-danger {
                border-color: #dc3545;
                color: #dc3545;
                background-color: transparent;
                border-radius: 8px !important;
            }

            .manual-check-row .btn-outline-danger:hover {
                background-color: rgba(220, 53, 69, 0.1);
                border-radius: 8px !important;
            }

            .manual-check-row .btn-check:checked + .btn-outline-danger {
                background-color: #dc3545;
                color: white;
                border-color: #dc3545;
                border-radius: 8px !important;
            }

            .manual-check-row .btn-outline-secondary {
                border-color: var(--secondary-color);
                color: var(--secondary-color);
                background-color: transparent;
                border-radius: 8px !important;
            }

            .manual-check-row .btn-outline-secondary:hover {
                background-color: rgba(90, 98, 104, 0.1);
                border-radius: 8px !important;
            }

            .manual-check-row .btn-check:checked + .btn-outline-secondary {
                background-color: var(--secondary-color);
                color: white;
                border-color: var(--secondary-color);
                border-radius: 8px !important;
            }

            .manual-check-notes {
                border-radius: 8px !important;
                font-size: 14px;
            }

            /* Center table cells vertically */
            .manual-check-row td {
                vertical-align: middle;
            }

            /* Logo and branding */
            .brand-logo-text {
                color: var(--text-dark);
            }

            .brand-access {
                color: var(--info-color);
                font-weight: 700;
            }

            .brand-it {
                color: var(--info-dark);
                font-weight: 700;
            }

            .brand-audit {
                font-weight: 400;
                font-size: 0.9rem;
            }

            /* Footer styles */
            .footer-text {
                font-size: 14px;
            }

            .footer-text-small {
                font-size: 12px;
            }

            .footer-link {
                font-size: 12px;
            }

            .footer-brand {
                color: var(--info-color);
            }

            /* Badge colors */
            .badge-axe-core {
                background-color: #00A7D0;
            }

            /* Table column widths */
            .col-criteria-number {
                width: 8%;
            }

            .col-criteria-level {
                width: 7%;
            }

            .col-criteria-description {
                width: 50%;
            }

            .col-criteria-status {
                width: 35%;
            }

            /* Accordion body scroll */
            .accordion-body-scroll {
                max-height: 400px;
                overflow-y: auto;
            }

            /* Theme card headers (dynamic colors via inline styles ok for Twig variables) */
            .theme-card-header {
                border-left-width: 4px;
                border-left-style: solid;
            }

            /* Progress bar full width */
            .progress-bar-full {
                width: 100%;
            }

            /* Small info text */
            .text-info-small {
                font-size: 0.75rem;
            }

            /* ============================================
               DARK MODE SPECIFIC IMPROVEMENTS
               ============================================ */

            [data-theme="dark"] {
                /* Force better text colors in dark mode */
            }

            /* Tableaux en mode sombre - FORCE SOMBRE */
            [data-theme="dark"] .table {
                --bs-table-bg: transparent !important;
                --bs-table-striped-bg: var(--bg-white) !important;
                --bs-table-hover-bg: var(--bg-light) !important;
                --bs-table-active-bg: var(--bg-light) !important;
                --bs-table-border-color: var(--border-color) !important;
                --bs-table-color: var(--text-medium) !important;
                color: var(--text-medium) !important;
                background-color: transparent !important;
            }

            [data-theme="dark"] .table thead,
            [data-theme="dark"] .table thead th,
            [data-theme="dark"] .table thead td {
                background-color: var(--bg-white) !important;
                color: var(--text-dark) !important;
                border-color: var(--border-color) !important;
            }

            [data-theme="dark"] .table-light,
            [data-theme="dark"] thead.table-light,
            [data-theme="dark"] .table > thead.table-light {
                --bs-table-bg: var(--bg-white) !important;
                --bs-table-color: var(--text-dark) !important;
                background-color: var(--bg-white) !important;
                color: var(--text-dark) !important;
            }

            [data-theme="dark"] .table-light th,
            [data-theme="dark"] thead.table-light th,
            [data-theme="dark"] .table > thead.table-light > tr > th {
                background-color: var(--bg-white) !important;
                color: var(--text-dark) !important;
                border-color: var(--border-color) !important;
            }

            [data-theme="dark"] .table tbody,
            [data-theme="dark"] .table tbody tr,
            [data-theme="dark"] .table tbody td,
            [data-theme="dark"] .table tbody th {
                background-color: transparent !important;
                color: var(--text-medium) !important;
                border-color: var(--border-color) !important;
            }

            [data-theme="dark"] .table-hover tbody tr:hover,
            [data-theme="dark"] .table-hover tbody tr:hover td,
            [data-theme="dark"] .table-hover tbody tr:hover th {
                --bs-table-hover-bg: var(--bg-light) !important;
                background-color: var(--bg-light) !important;
                color: var(--text-dark) !important;
            }

            /* Card contenant le tableau */
            [data-theme="dark"] .card .table-responsive {
                background-color: transparent !important;
            }

            /* Lignes de tableau */
            [data-theme="dark"] .audit-row {
                background-color: transparent !important;
            }

            [data-theme="dark"] .audit-row:hover {
                background-color: var(--bg-light) !important;
            }

            /* Labels et small text en mode sombre */
            [data-theme="dark"] .form-label,
            [data-theme="dark"] .stat-label,
            [data-theme="dark"] small {
                color: var(--text-light) !important;
            }

            [data-theme="dark"] .text-muted {
                color: var(--text-light) !important;
            }

            /* Am√©lioration des cartes en mode sombre */
            [data-theme="dark"] .card {
                background-color: var(--card-bg) !important;
            }

            [data-theme="dark"] .card-header {
                color: var(--text-dark);
                background-color: var(--card-bg) !important;
                border-bottom-color: var(--border-color);
            }

            [data-theme="dark"] .card-body {
                color: var(--text-medium);
                background-color: var(--card-bg) !important;
            }

            [data-theme="dark"] .card-footer {
                background-color: var(--card-bg) !important;
                color: var(--text-medium);
                border-top-color: var(--border-color);
            }

            /* Force les backgrounds Bootstrap √† √™tre sombres */
            [data-theme="dark"] .bg-white {
                background-color: var(--bg-white) !important;
            }

            [data-theme="dark"] .bg-light {
                background-color: var(--bg-light) !important;
            }

            /* Dropdown menu en mode sombre */
            [data-theme="dark"] .dropdown-menu {
                background-color: var(--card-bg);
                border: 1px solid var(--border-color);
            }

            [data-theme="dark"] .dropdown-item {
                color: var(--text-medium);
            }

            [data-theme="dark"] .dropdown-item:hover {
                background-color: var(--bg-light);
                color: var(--text-dark);
            }

            /* Liens en mode sombre */
            [data-theme="dark"] a:not(.btn):not(.nav-link):not(.dropdown-item) {
                color: var(--info-color);
            }

            [data-theme="dark"] a:not(.btn):not(.nav-link):not(.dropdown-item):hover {
                color: var(--info-dark);
            }

            /* Alertes en mode sombre */
            [data-theme="dark"] .alert {
                background-color: var(--card-bg);
                border: 1px solid var(--border-color);
                color: var(--text-medium);
            }

            [data-theme="dark"] .alert-info {
                background-color: rgba(41, 182, 246, 0.15);
                border-color: rgba(41, 182, 246, 0.3);
                color: #81d4fa;
            }

            [data-theme="dark"] .alert-success {
                background-color: rgba(102, 187, 106, 0.15);
                border-color: rgba(102, 187, 106, 0.3);
                color: #a5d6a7;
            }

            [data-theme="dark"] .alert-warning {
                background-color: rgba(255, 193, 7, 0.15);
                border-color: rgba(255, 193, 7, 0.3);
                color: #ffd54f;
            }

            [data-theme="dark"] .alert-danger {
                background-color: rgba(220, 53, 69, 0.15);
                border-color: rgba(220, 53, 69, 0.3);
                color: #ef5350;
            }

            /* Badges en mode sombre */
            [data-theme="dark"] .badge.bg-secondary {
                background-color: #616161 !important;
            }

            /* Pagination en mode sombre */
            [data-theme="dark"] .pagination .page-link {
                background-color: var(--card-bg);
                border-color: var(--border-color);
                color: var(--text-medium);
            }

            [data-theme="dark"] .pagination .page-link:hover {
                background-color: var(--bg-light);
                color: var(--text-dark);
            }

            [data-theme="dark"] .pagination .page-item.active .page-link {
                background-color: var(--primary-color);
                border-color: var(--primary-color);
                color: #000;
            }

            [data-theme="dark"] .pagination .page-item.disabled .page-link {
                background-color: var(--bg-white);
                color: var(--text-light);
            }

            /* Inputs et selects en mode sombre */
            [data-theme="dark"] .form-control,
            [data-theme="dark"] .form-select {
                background-color: var(--input-bg);
                border-color: var(--border-color);
                color: var(--text-dark);
            }

            [data-theme="dark"] .form-control::placeholder {
                color: var(--text-light);
            }

            [data-theme="dark"] .form-control:focus,
            [data-theme="dark"] .form-select:focus {
                background-color: var(--input-bg);
                color: var(--text-dark);
                border-color: var(--info-color);
            }

            /* Strong/Bold text en mode sombre */
            [data-theme="dark"] strong,
            [data-theme="dark"] b {
                color: var(--text-dark);
            }

            /* Text utilities en mode sombre */
            [data-theme="dark"] .text-success {
                color: var(--success-color) !important;
            }

            [data-theme="dark"] .text-danger {
                color: #ef5350 !important;
            }

            [data-theme="dark"] .text-warning {
                color: #ffd54f !important;
            }

            [data-theme="dark"] .text-info {
                color: var(--info-color) !important;
            }

            [data-theme="dark"] .text-primary {
                color: var(--primary-color) !important;
            }

            /* Stat numbers en mode sombre */
            [data-theme="dark"] .stat-number {
                color: inherit;
            }

            /* List group en mode sombre */
            [data-theme="dark"] .list-group-item {
                background-color: var(--card-bg);
                border-color: var(--border-color);
                color: var(--text-medium);
            }

            /* Accord√©on en mode sombre */
            [data-theme="dark"] .accordion-button {
                background-color: var(--bg-light);
                color: var(--text-dark);
            }

            [data-theme="dark"] .accordion-button:not(.collapsed) {
                background-color: var(--bg-white);
                color: var(--text-dark);
            }

            [data-theme="dark"] .accordion-body {
                background-color: var(--card-bg);
                color: var(--text-medium);
            }

            /* Footer en mode sombre */
            [data-theme="dark"] .footer {
                background-color: var(--footer-bg) !important;
                color: var(--text-medium);
                border-top-color: var(--border-color) !important;
            }

            [data-theme="dark"] .footer.bg-white {
                background-color: var(--footer-bg) !important;
            }

            [data-theme="dark"] .footer .text-muted {
                color: var(--text-light) !important;
            }

            [data-theme="dark"] .footer a {
                color: var(--text-light) !important;
            }

            [data-theme="dark"] .footer a:hover {
                color: var(--info-color) !important;
            }

            [data-theme="dark"] .footer strong {
                color: var(--text-dark) !important;
            }

            /* Fix pour les √©l√©ments souvent illisibles en mode sombre */

            /* Tous les paragraphes et divs */
            [data-theme="dark"] p,
            [data-theme="dark"] div:not(.card):not(.alert):not(.badge):not(.btn) {
                color: var(--text-medium);
            }

            /* Am√©lioration des badges secondaires */
            [data-theme="dark"] .badge.bg-dark {
                background-color: #616161 !important;
                color: #fff !important;
            }

            /* Text break (URLs longues) */
            [data-theme="dark"] .text-break {
                color: var(--info-color);
            }

            /* Small badges dans les cards */
            [data-theme="dark"] .badge.bg-secondary,
            [data-theme="dark"] .badge.badge-secondary {
                background-color: #757575 !important;
                color: #fff !important;
            }

            /* Priority cards issue list */
            [data-theme="dark"] .list-group-item {
                background-color: var(--card-bg) !important;
                color: var(--text-medium) !important;
                border-color: var(--border-color) !important;
            }

            [data-theme="dark"] .list-group-item .small,
            [data-theme="dark"] .list-group-item small {
                color: var(--text-light) !important;
            }

            [data-theme="dark"] .list-group-item h6,
            [data-theme="dark"] .list-group-item .fw-bold {
                color: var(--text-dark) !important;
            }

            /* Alert contenu */
            [data-theme="dark"] .alert small,
            [data-theme="dark"] .alert .small {
                color: inherit;
                opacity: 0.9;
            }

            [data-theme="dark"] .alert strong {
                color: inherit;
                font-weight: 700;
            }

            /* Labels dans les stats */
            [data-theme="dark"] .stat-value {
                color: inherit !important;
            }

            [data-theme="dark"] .stat-sublabel {
                color: var(--text-light) !important;
            }

            /* Info boxes */
            [data-theme="dark"] .info-box,
            [data-theme="dark"] .alert-light {
                background-color: var(--card-bg) !important;
                color: var(--text-medium) !important;
                border-color: var(--border-color) !important;
            }

            /* Badges dans les cartes priority */
            [data-theme="dark"] .badge.bg-primary {
                background-color: var(--primary-color) !important;
                color: #000 !important;
            }

            /* Theme colors badges */
            [data-theme="dark"] span[style*="background-color"] {
                filter: brightness(1.2);
            }

            /* Code blocks */
            [data-theme="dark"] code,
            [data-theme="dark"] pre {
                background-color: var(--code-bg) !important;
                color: #e0e0e0 !important;
                border-color: var(--border-color) !important;
            }

            /* Headers de sections */
            [data-theme="dark"] h1,
            [data-theme="dark"] h2,
            [data-theme="dark"] h3,
            [data-theme="dark"] h4,
            [data-theme="dark"] h5,
            [data-theme="dark"] h6 {
                color: var(--text-dark) !important;
            }

            /* Border sur cards */
            [data-theme="dark"] .card {
                border: 1px solid var(--border-color) !important;
            }

            /* Stat cards en mode sombre */
            [data-theme="dark"] .stat-card {
                background-color: var(--card-bg);
                color: var(--text-medium);
            }

            /* Nav tabs */
            [data-theme="dark"] .nav-tabs {
                border-bottom-color: var(--border-color);
            }

            [data-theme="dark"] .nav-tabs .nav-link {
                color: var(--text-medium) !important;
            }

            [data-theme="dark"] .nav-tabs .nav-link.active {
                color: var(--info-color) !important;
                background-color: var(--card-bg) !important;
            }

            /* Tab content */
            [data-theme="dark"] .tab-content {
                background-color: transparent;
                color: var(--text-medium);
            }

            /* Breadcrumb */
            [data-theme="dark"] .breadcrumb {
                background-color: var(--bg-light);
            }

            [data-theme="dark"] .breadcrumb-item,
            [data-theme="dark"] .breadcrumb-item a {
                color: var(--text-medium);
            }

            [data-theme="dark"] .breadcrumb-item.active {
                color: var(--text-light);
            }

            /* Images en mode sombre (l√©g√®re transparence) */
            [data-theme="dark"] img:not(.navbar-brand img):not(.footer img) {
                opacity: 0.9;
            }

            /* Border colors g√©n√©riques */
            [data-theme="dark"] .border,
            [data-theme="dark"] .border-top,
            [data-theme="dark"] .border-bottom,
            [data-theme="dark"] .border-left,
            [data-theme="dark"] .border-right {
                border-color: var(--border-color) !important;
            }

            /* Text colors utilities FORCE */
            [data-theme="dark"] .text-dark {
                color: var(--text-dark) !important;
            }

            [data-theme="dark"] .text-secondary {
                color: var(--text-medium) !important;
            }

            /* Disabled elements */
            [data-theme="dark"] .btn:disabled,
            [data-theme="dark"] .btn.disabled {
                opacity: 0.5;
            }

            /* Modal en mode sombre */
            [data-theme="dark"] .modal-content {
                background-color: var(--card-bg) !important;
                border-color: var(--border-color) !important;
            }

            [data-theme="dark"] .modal-header,
            [data-theme="dark"] .modal-body,
            [data-theme="dark"] .modal-footer {
                background-color: var(--card-bg) !important;
                color: var(--text-medium) !important;
                border-color: var(--border-color) !important;
            }

            /* Close buttons */
            [data-theme="dark"] .btn-close {
                filter: invert(1);
            }
        </style>
    {% endblock %}
</head>
<body>
    {% block navbar %}
        <nav class="navbar navbar-expand-lg navbar-light bg-white">
            <div class="container-fluid px-4">
                <a class="navbar-brand d-flex align-items-center" href="{{ path('app_dashboard') }}">
                    <img src="/images/logo-itroom.png" alt="IT-Room" height="45" class="me-3">
                    <span class="brand-logo-text">
                        <span class="brand-access">Access</span><span class="brand-it">IT</span>
                        <span class="brand-audit">Audit</span>
                    </span>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto align-items-center">
                        {% if app.user %}
                            <li class="nav-item me-3">
                                <label class="theme-toggle">
                                    <input type="checkbox" id="theme-toggle-checkbox">
                                    <span class="theme-toggle-slider"></span>
                                </label>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                                    <i class="bi bi-person-circle"></i> {{ app.user.name }}
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" href="{{ path('app_logout') }}">
                                        <i class="bi bi-box-arrow-right"></i> D√©connexion
                                    </a></li>
                                </ul>
                            </li>
                        {% else %}
                            <li class="nav-item">
                                <a class="nav-link" href="{{ path('app_login') }}">
                                    <i class="bi bi-box-arrow-in-right"></i> Connexion
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </nav>
    {% endblock %}

    {% block body_content %}
        <div class="container-fluid">
            <div class="row">
                {% if app.user %}
                    {# Overlay pour fermer la sidebar sur mobile #}
                    <div class="sidebar-overlay" id="sidebarOverlay"></div>

                    {# Bouton toggle pour mobile (FAB - Floating Action Button) #}
                    <button class="sidebar-toggle" id="sidebarToggle" aria-label="Ouvrir le menu">
                        <i class="bi bi-list"></i>
                    </button>

                    {% block sidebar %}
                        <nav class="col-md-2 d-md-block sidebar" id="sidebar">
                            <div class="position-sticky pt-3">
                                <ul class="nav flex-column">
                                    <li class="nav-item">
                                        <a class="nav-link" href="{{ path('app_dashboard') }}">
                                            <i class="bi bi-speedometer2"></i> Dashboard
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="{{ path('app_project_list') }}">
                                            <i class="bi bi-folder"></i> Projets
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="{{ path('app_audit_list') }}">
                                            <i class="bi bi-clipboard-check"></i> Audits
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" href="{{ path('app_audit_new') }}">
                                            <i class="bi bi-plus-circle"></i> Nouvel audit
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </nav>
                    {% endblock %}

                    <main class="col-md-10 ms-sm-auto content-area">
                {% else %}
                    <main class="col-12 content-area">
                {% endif %}
                        {% for label, messages in app.flashes %}
                            {% for message in messages %}
                                <div class="alert alert-{{ label == 'error' ? 'danger' : label }} alert-dismissible fade show" role="alert">
                                    {{ message }}
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                            {% endfor %}
                        {% endfor %}

                        {% block content %}{% endblock %}
                    </main>
            </div>
        </div>
    {% endblock %}

    {% block footer %}
        <footer class="footer mt-5 py-4 bg-white border-top">
            <div class="container-fluid px-4">
                <div class="row align-items-center">
                    <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                        <img src="/images/logo-itroom.png" alt="IT-Room" height="60" class="mb-2">
                        <p class="text-muted mb-0 footer-text">
                            Solution d'audit d'accessibilit√© web RGAA/WCAG
                        </p>
                    </div>
                    <div class="col-md-6 text-center text-md-end">
                        <p class="text-muted mb-1 footer-text">
                            Propuls√© par <strong class="footer-brand">IT-Room</strong>
                        </p>
                        <p class="text-muted mb-0 footer-text-small">
                            ¬© {{ "now"|date("Y") }} AccessIT Audit - Tous droits r√©serv√©s
                        </p>
                        <div class="mt-2">
                            <a href="https://www.itroom.fr" target="_blank" class="text-muted me-3 footer-link">
                                <i class="bi bi-globe"></i> www.itroom.fr
                            </a>
                            <a href="#" class="text-muted footer-link">
                                <i class="bi bi-shield-check"></i> Mentions l√©gales
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    {% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <script>
        // Dark Mode Toggle
        const themeToggle = document.getElementById('theme-toggle-checkbox');
        const htmlElement = document.documentElement;

        // Charger le th√®me sauvegard√© ou utiliser le th√®me syst√®me
        const savedTheme = localStorage.getItem('theme');
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const currentTheme = savedTheme || (systemPrefersDark ? 'dark' : 'light');

        // Appliquer le th√®me au chargement
        if (currentTheme === 'dark') {
            htmlElement.setAttribute('data-theme', 'dark');
            themeToggle.checked = true;
        }

        // G√©rer le toggle
        themeToggle.addEventListener('change', function() {
            if (this.checked) {
                htmlElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            } else {
                htmlElement.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
            }
        });

        // √âcouter les changements de pr√©f√©rence syst√®me
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (!localStorage.getItem('theme')) {
                if (e.matches) {
                    htmlElement.setAttribute('data-theme', 'dark');
                    themeToggle.checked = true;
                } else {
                    htmlElement.removeAttribute('data-theme');
                    themeToggle.checked = false;
                }
            }
        });

        // Sidebar Toggle for Mobile
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');

        if (sidebarToggle && sidebar && sidebarOverlay) {
            // Ouvrir/Fermer la sidebar
            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.toggle('show');
                sidebarOverlay.classList.toggle('show');

                // Changer l'ic√¥ne
                const icon = this.querySelector('i');
                if (sidebar.classList.contains('show')) {
                    icon.className = 'bi bi-x';
                    this.setAttribute('aria-label', 'Fermer le menu');
                } else {
                    icon.className = 'bi bi-list';
                    this.setAttribute('aria-label', 'Ouvrir le menu');
                }
            });

            // Fermer en cliquant sur l'overlay
            sidebarOverlay.addEventListener('click', function() {
                sidebar.classList.remove('show');
                sidebarOverlay.classList.remove('show');

                const icon = sidebarToggle.querySelector('i');
                icon.className = 'bi bi-list';
                sidebarToggle.setAttribute('aria-label', 'Ouvrir le menu');
            });

            // Fermer en cliquant sur un lien de la sidebar (navigation)
            const sidebarLinks = sidebar.querySelectorAll('.nav-link');
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function() {
                    // Sur mobile, fermer la sidebar apr√®s clic
                    if (window.innerWidth < 768) {
                        sidebar.classList.remove('show');
                        sidebarOverlay.classList.remove('show');

                        const icon = sidebarToggle.querySelector('i');
                        icon.className = 'bi bi-list';
                        sidebarToggle.setAttribute('aria-label', 'Ouvrir le menu');
                    }
                });
            });

            // Fermer avec la touche Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && sidebar.classList.contains('show')) {
                    sidebar.classList.remove('show');
                    sidebarOverlay.classList.remove('show');

                    const icon = sidebarToggle.querySelector('i');
                    icon.className = 'bi bi-list';
                    sidebarToggle.setAttribute('aria-label', 'Ouvrir le menu');
                }
            });
        }
    </script>

    {% block javascripts %}{% endblock %}
</body>
</html>
